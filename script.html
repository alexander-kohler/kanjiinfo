<script>
  function hideKanjiPopup() {
    document
      .querySelectorAll(".kanji-popup-content")
      .forEach((p) => (p.style.display = "none"));
  }

  function showKanjiPopup(char) {
    hideKanjiPopup();
    const popup = document.getElementById("popup-" + char);
    if (popup) popup.style.display = "flex";
  }

  document.addEventListener("click", function (e) {
    if (e.target.classList.contains("nested-kanji")) {
      const char = e.target.dataset.kanji;
      showKanjiPopup(char);
    }
  });

  function toggleStory(id) {
    const body = document.getElementById(id);
    const toggle = document.getElementById("toggle-" + id);
    const isHidden = body.classList.toggle("hidden");
    toggle.textContent = isHidden ? "[+]" : "[âˆ’]";
  }
</script>
