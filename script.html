<script>
  function hideKanjiPopup() {
    document
      .querySelectorAll(".kanji-popup-content")
      .forEach((p) => (p.style.display = "none"));
  }

  function showKanjiPopup(char) {
    hideKanjiPopup();
    const popup = document.getElementById("popup-" + char);
    if (popup) popup.style.display = "flex";
  }

  document.addEventListener("click", function (e) {
    if (e.target.classList.contains("nested-kanji")) {
      const char = e.target.dataset.kanji;
      showKanjiPopup(char);
    }
  });

  function toggleStory(id) {
    const body = document.getElementById(id);
    const toggle = document.getElementById("toggle-" + id);
    const isHidden = body.classList.toggle("hidden");
    toggle.textContent = isHidden ? "[+]" : "[−]";
  }

  function toggleKanjiDetails(details_id) {
    const body = document.getElementById(details_id);
    const toggle = document.getElementById("toggle-" + details_id);
    const isHidden = body.classList.toggle("hidden");
    toggle.textContent = isHidden ? "[+]" : "[−]";
  }

  function showLargePopup(el, kanji) {
    console.log("clicked:", kanji);
    var popup = document.getElementById("stroke-order-popup-" + kanji);
    if (!popup) return;
    popup.innerText = kanji;
    popup.style.display = "block";
  }
</script>
